{% extends 'base.html.twig' %}

{% block title %}Touch Grass{% endblock %}


  {% block stylesheets %}
      <link rel="stylesheet" href="{{ asset('Css/table.css') }}">
  {% endblock %}

{% block body %}
    <div id="info">
        <h2>Date du Jour : {{ "now" | date("m/d/Y") }}</h2>
        <h2>
            {% if app.user %}
                Participant : {{ app.user.pseudo }}
            {% else %}
                Pensez à vous connecter pour participer
            {% endif %}
        </h2>
    </div>
    <div id="filtre">
        <p>Filtrer les Sorties</p>
        <div style="display: flex;justify-content: space-around;">
            <div>
                {{ form(filtreForm) }}
            </div>
            <div>
                <div>
                    <input type="checkbox" id="chkOrag" name="chkOrag">
                    <label for="chkOrag">Sortie dont je suis l'organisateur/trice</label>
                </div>
                <div>
                    <input type="checkbox" id="chkInscrit" name="chkInscrit">
                    <label for="chkInscrit">Sortie auxquelles je suis inscrit/e</label>
                </div>
                <div>
                    <input type="checkbox" id="chkNoInscrit" name="chkNoInscrit">
                    <label for="chkNoInscrit">Sortie auxquelles je ne suis pas inscrit/e</label>
                </div>
                <div>
                    <input type="checkbox" id="chkPasse" name="chkPasse">
                    <label for="chkPasse">Sortie passée</label>
                </div>
            </div>
        </div>
    </div>
    <div id="dvg">
        <table>
            <thead>
            <tr>
                <th>Nom de la Sortie</th>
                <th>Date de la Sortie</th>
                <th>Clôture</th>
                <th>Inscrit/Places</th>
                <th>Etat</th>
                {% if app.user %}
                    <th>Inscrit</th>
                {% endif %}
                <th>Organisateur</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                {% for sortie in lesSorties %}
                    {# Nom #}
                    <td>{{ sortie.Nom }}</td>
                    {# dateDeb #}
                    <td>{{ sortie.Datedebut | date("m/d/Y") }}</td>
                    {# dateFin #}
                    <td>{{ sortie.Datecloture | date("m/d/Y") }}</td>
                    {# nbInscrit/QteMax #}
                    <td>{{ sortie.IdInscription.ParticipantsNoParticipant|length }}/{{ sortie.Nbinscriptionsmax }}</td>
                    {# Etat #}
                    <td>{{ sortie.EtatsNoEtat.Libelle }}</td>
                    {# inscrit visible que une fois connecter #}
                    {% if app.user %}
                        <td>
                            {% for participant in sortie.IdInscription.ParticipantsNoParticipant %}
                                {% if app.user==participant %}
                                    X
                                {% endif %}
                            {% endfor %}
                        </td>
                    {% endif %}
                    {# pseudo de l'organisateur #}
                    <td>{{ sortie.Organisateur.Pseudo }}</td>
                    {# Action #}
                    {% if sortie.EtatsNoEtat.Id != 1 %}
                        <td><a href="{{ path('sortie_sortie', {'id': sortie.Id}) }}">Afficher</a>
                        {% if app.user %}
                            {% if app.user.pseudo == sortie.Organisateur.Pseudo %}
                                - Annuler</td>
                            {% elseif sortie.IdInscription.ParticipantsNoParticipant|length != sortie.Nbinscriptionsmax %}
                                {% for participant in sortie.IdInscription.ParticipantsNoParticipant %}
                                    {% if app.user==participant %}
                                        - Se désister</td>
                                    {% endif %}
                                {% else %}
                                    - S'inscrire</td>
                                {% endfor %}
                            {% endif %}
                        {% else %}
                            </td>
                        {% endif %}
                    {% else %}
                        {% if app.user %}
                            {% if app.user.pseudo == sortie.Organisateur.Pseudo %}
                                <td>Modifier - Publier</td>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </tr>
            </tbody>
        </table>
    </div>
    <button><a href="{{ path('sortie_addSortie') }}">Créer une sortie</a></button>



{% endblock %}
